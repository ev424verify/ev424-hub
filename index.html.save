<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark" />
  <title>EV424 — Evidence Verification</title>

  <style>
    :root{
      --bg0:#07090c;
      --bg1:#0b0f14;
      --card:#0f1620;
      --card2:#0c131b;
      --text:#e8eef6;
      --muted:#a9b6c6;

      /* GREEN TONE (slightly softer than before) */
      --accent:#2bd37b;          /* softer */
      --accent2:#19b96a;         /* deeper */
      --accentGlow: rgba(43,211,123,.22);

      --border: rgba(255,255,255,.08);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius: 16px;
      --radius2: 22px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 70% 30%, rgba(43,211,123,.10), transparent 60%),
        radial-gradient(1000px 600px at 20% 70%, rgba(255,255,255,.06), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    a{ color:inherit; text-decoration:none; }
    .wrap{ max-width: 980px; margin: 0 auto; padding: 22px 16px 70px; }

    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding: 10px 0 14px;
    }
    .brand{
      display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px;
    }
    .logoDot{
      width:10px; height:10px; border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(43,211,123,.10);
    }
    .pill{
      font-size:12px; font-weight:650; color:#bfead3;
      padding:7px 10px; border-radius:999px;
      border:1px solid rgba(43,211,123,.35);
      background: rgba(43,211,123,.08);
      backdrop-filter: blur(6px);
      white-space:nowrap;
    }

    .hero{
      margin-top: 12px;
      padding: 22px 18px;
      border-radius: var(--radius2);
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
    }
    .hero h1{
      margin: 2px 0 10px;
      font-size: clamp(26px, 4.6vw, 40px);
      line-height: 1.05;
      letter-spacing: -0.6px;
    }
    .hero p{
      margin: 0;
      color: var(--muted);
      max-width: 62ch;
      line-height: 1.5;
      font-size: 14.5px;
    }
    .hero .mini{
      margin-top: 10px;
      display:flex; flex-wrap:wrap; gap:10px;
    }
    .stat{
      flex: 1 1 210px;
      padding: 12px 12px;
      border-radius: 14px;
      border:1px solid var(--border);
      background: rgba(10,14,19,.55);
    }
    .stat .k{ font-size: 12px; color: var(--muted); }
    .stat .v{ margin-top:6px; font-size: 15px; font-weight: 720; }

    .grid{
      margin-top: 16px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }

    .card{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(12,18,26,.62);
      box-shadow: 0 10px 40px rgba(0,0,0,.38);
      overflow:hidden;
    }
    .cardHeader{
      padding: 14px 16px 10px;
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .cardHeader h2{
      margin:0;
      font-size: 14px;
      letter-spacing: .2px;
      color: #dbe6f3;
    }
    .cardBody{ padding: 14px 16px 16px; }

    .row{ display:flex; gap:10px; flex-wrap:wrap; }
    .field{
      flex: 1 1 320px;
      display:flex; flex-direction:column; gap:8px;
    }
    label{
      font-size: 12px;
      color: var(--muted);
    }
    input{
      width:100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      color: var(--text);
      outline:none;
      font-size: 14px;
    }
    input:focus{
      border-color: rgba(43,211,123,.55);
      box-shadow: 0 0 0 4px rgba(43,211,123,.10);
    }

    .btn{
      appearance:none;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 12px 14px;
      border-radius: 12px;
      font-weight: 750;
      cursor:pointer;
      transition: transform .06s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    .btn:hover{ background: rgba(255,255,255,.09); }
    .btn:active{ transform: translateY(1px); }
    .btnPrimary{
      border-color: rgba(43,211,123,.45);
      background: linear-gradient(180deg, rgba(43,211,123,.85), rgba(25,185,106,.85));
      color:#07110a;
      box-shadow: 0 16px 60px var(--accentGlow);
    }
    .btnPrimary:hover{
      background: linear-gradient(180deg, rgba(43,211,123,.92), rgba(25,185,106,.92));
    }
    .btnWide{ width:100%; }

    .muteline{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12.5px;
      line-height:1.45;
    }

    .doclinks{
      display:flex; gap:10px; flex-wrap:wrap;
    }

    .docbtn{
      flex: 1 1 240px;
      text-align:center;
    }

    .result{
      margin-top: 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      border-radius: 14px;
      padding: 12px;
      display:none;
    }
    .result.show{ display:block; }
    .result .title{ font-weight: 800; margin-bottom: 6px; }
    .result pre{
      margin:0;
      white-space: pre-wrap;
      word-break: break-word;
      color: #d7e3f1;
      font-size: 12.5px;
      line-height: 1.45;
    }

    .footerCta{
      position: sticky;
      bottom: 0;
      margin-top: 22px;
      padding-top: 12px;
      background: linear-gradient(180deg, rgba(7,9,12,0), rgba(7,9,12,.78) 30%, rgba(7,9,12,.92));
      backdrop-filter: blur(6px);
    }

    @media (min-width: 880px){
      .grid{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logoDot" aria-hidden="true"></div>
        <div>EV424</div>
      </div>
      <div class="pill">VERIFIED SYSTEM</div>
    </div>

    <section class="hero">
      <h1>Evidence-Based Verification Engine</h1>
      <p>
        No performance claims. No subjective interpretation.
        Only reproducible evidence sealed by deterministic verification.
      </p>

      <div class="mini">
        <div class="stat">
          <div class="k">Integrity Status</div>
          <div class="v">PASS — SHA-256 Sealed</div>
        </div>
        <div class="stat">
          <div class="k">Verification Mode</div>
          <div class="v">Deterministic Reproduction</div>
        </div>
        <div class="stat">
          <div class="k">Evidence Policy</div>
          <div class="v">Reproducible Evidence Only</div>
        </div>
      </div>
    </section>
    <section class="grid">

      <!-- Technical Documentation -->
      <div class="card" id="docs">
        <div class="cardHeader">
          <h2>Technical Documentation</h2>
        </div>
        <div class="cardBody">
          <div class="doclinks">
            <a class="btn docbtn" href="https://ev424verify.pages.dev" target="_blank" rel="noopener">Open Main Site</a>
            <a class="btn docbtn" href="https://ev424verify.pages.dev" target="_blank" rel="noopener">Public Docs (Viewer)</a>
          </div>
          <div class="muteline">
            Note: This page verifies public evidence artifacts by hash/ID.
          </div>
        </div>
      </div>

      <!-- Verify by Hash / ID -->
      <div class="card" id="verify">
        <div class="cardHeader">
          <h2>Verify by Hash / ID</h2>
        </div>
        <div class="cardBody">
          <div class="row">
            <div class="field">
              <label for="q">Enter SHA-256 or Evidence ID</label>
              <input id="q" inputmode="text" autocomplete="off" spellcheck="false"
                     placeholder="e.g., b347c7b650777b7f339c3563d046dbc45fecc..." />
            </div>
            <div class="field" style="flex:0 0 220px; min-width: 220px;">
              <label>&nbsp;</label>
              <!-- IMPORTANT: type="button" so it NEVER silently submits/reloads -->
              <button id="btnCheck" class="btn btnWide" type="button">Check Evidence</button>
            </div>
          </div>

          <div id="res" class="result" aria-live="polite">
            <div class="title" id="resTitle">Result</div>
            <pre id="resBody"></pre>
          </div>

          <div class="muteline">
            How it works: We load a public index (toc.json) and match your SHA/ID against it.
            If found, we show the referenced artifact and metadata.
          </div>
        </div>
      </div>

      <!-- Why Document Passport -->
      <div class="card">
        <div class="cardHeader">
          <h2>Why Document Passport?</h2>
        </div>
        <div class="cardBody">
          <div class="muteline" style="font-size:13.5px;">
            The problem is not “trust”. The problem is that files can be changed without leaving a visible trace.
            EV424 converts documents into reproducible evidence:
            <b>FILE → HASH → MANIFEST → RE-VERIFY</b>.
            <br><br>
            EV424 does not negotiate with ambiguity: evidence is accepted <b>only when reproducible</b>.
          </div>
        </div>
      </div>

      <!-- Philosophy -->
      <div class="card">
        <div class="cardHeader">
          <h2>Philosophy</h2>
        </div>
        <div class="cardBody">
          <div class="muteline" style="font-size:13.5px;">
            EV424 does not predict.<br>
            EV424 does not promise performance.<br>
            We record only verifiable evidence.<br>
            Evidence is accepted only when reproducible.<br><br>
            <b>Not interpretation — proof.</b><br>
            <b>Not opinion — reproduction.</b><br>
            <span style="color: var(--accent); font-weight:800;">Accuracy(4) → Truth(2) → Life(4)</span>
          </div>
        </div>
      </div>

    </section>

    <!-- Sticky bottom CTA (keep it, but tone already softened via --accent) -->
    <div class="footerCta">
      <button id="btnJump" class="btn btnPrimary btnWide" type="button">Verify Now</button>
    </div>
  </div> <!-- /wrap -->

  <script>
    // Config: where the public evidence index lives.
    // Your screenshot shows: /public_data/toc.json
    const TOC_URL = "/public_data/toc.json";

    function showResult(title, bodyObjOrText) {
      const res = document.getElementById("res");
      const resTitle = document.getElementById("resTitle");
      const resBody = document.getElementById("resBody");

      resTitle.textContent = title;

      if (typeof bodyObjOrText === "string") {
        resBody.textContent = bodyObjOrText;
      } else {
        resBody.textContent = JSON.stringify(bodyObjOrText, null, 2);
      }

      res.classList.add("show");
      res.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }

    function norm(s) {
      return (s || "").trim();
    }

    function isSha256(s) {
      return /^[a-f0-9]{64}$/i.test(s);
    }

    async function loadToc() {
      const r = await fetch(TOC_URL, { cache: "no-store" });
      if (!r.ok) throw new Error("TOC fetch failed: " + r.status);
      return await r.json();
    }

    function findHit(toc, query) {
      // Support a few flexible toc formats:
      // 1) { items: [ {sha256, id, url, path, ...}, ... ] }
      // 2) [ {sha256, id, ...}, ... ]
      // 3) { ... } (single object)
      const items = Array.isArray(toc) ? toc : (Array.isArray(toc.items) ? toc.items : null);

      if (items) {
        const q = query.toLowerCase();
        return items.find(it => {
          const sha = (it.sha256 || it.hash || it.SHA256 || "").toLowerCase();
          const id  = (it.id || it.evidence_id || it.EVIDENCE_ID || "").toLowerCase();
          return (sha && sha === q) || (id && id === q);
        }) || null;
      }

      // If toc is an object map: { "<sha>": {...}, "<id>": {...} }
      if (toc && typeof toc === "object") {
        const q = query.toLowerCase();
        if (toc[q]) return toc[q];
      }

      return null;
    }

    async function onCheck() {
      const q = norm(document.getElementById("q").value);
      if (!q) {
        showResult("Input required", "Enter a SHA-256 (64 hex) or an Evidence ID.");
        return;
      }

      try {
        const toc = await loadToc();
        const hit = findHit(toc, q);

        if (!hit) {
          showResult("NOT FOUND", {
            query: q,
            message: "No matching evidence in public index (toc.json).",
            hint: "Confirm you deployed /public_data/toc.json and that it contains this SHA/ID."
          });
          return;
        }

        // If hit contains a URL/path, surface it.
        const out = Object.assign({}, hit);
        out.query = q;
        out.index = TOC_URL;

        showResult("FOUND", out);

        // Optional: if a URL exists, open in a new tab.
        const url = hit.url || hit.link || hit.href || null;
        if (url && typeof url === "string" && url.startsWith("http")) {
          window.open(url, "_blank", "noopener");
        }

      } catch (e) {
        showResult("ERROR", {
          query: q,
          error: String(e && e.message ? e.message : e),
          check: [
            "Is /public_data/toc.json deployed?",
            "Open /public_data/toc.json in browser and confirm JSON is valid."
          ]
        });
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      // Bind buttons AFTER DOM is ready => no 'not clickable' bug.
      document.getElementById("btnCheck").addEventListener("click", onCheck);

      document.getElementById("btnJump").addEventListener("click", () => {
        document.getElementById("verify").scrollIntoView({ behavior: "smooth", block: "start" });
        document.getElementById("q").focus();
      });

      // Enter key triggers check
      document.getElementById("q").addEventListener("keydown", (ev) => {
        if (ev.key === "Enter") onCheck();
      });
    });
  </script>
</body>
</html>
